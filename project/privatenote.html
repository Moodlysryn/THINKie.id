<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Note editor</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <link rel="stylesheet" href="../css/stylenoteedit.css" />
  </head>
  <body>
    <body>
      <div class="editor-panel">
        <div class="topbar">
          <a href="../project/notification.html"
            ><i class="fa-regular fa-bell"></i
          ></a>
          <a href="../project/popupfolder.html"
            ><i class="fa-regular fa-image"></i
          ></a>
        </div>
        <input type="text" class="title-input" placeholder="Tittle" />

        <!-- List -->
        <div class="todo-item">
          <input type="checkbox" />
          <div contenteditable="true" id="editor-list">Your list...</div>
        </div>
      </div>

      <!-- Toolbar -->
      <div class="toolbar">
        <button onclick="format('formatBlock','<h1>')">H1</button>
        <button onclick="format('formatBlock','<h2>')">H2</button>
        <button onclick="format('removeFormat')">Aa</button>
        <button onclick="format('bold')"><b>B</b></button>
        <button onclick="format('italic')"><i>I</i></button>
        <button onclick="format('underline')"><u>U</u></button>
        <button onclick="format('strikeThrough')"><s>S</s></button>
        <button onclick="createLink()"><i class="fa-solid fa-link"></i></button>
      </div>
    </body>

    <script>
      const toolbar = document.querySelector(".toolbar");
      const editors = document.querySelectorAll(".editable");

      // aktifkan editor
      let activeEditor = null;
      editors.forEach((ed) => {
        ed.addEventListener("focus", () => (activeEditor = ed));
      });

      toolbar.addEventListener("click", (e) => {
        const btn = e.target.closest("button");
        if (!btn || !activeEditor) return;

        const cmd = btn.dataset.cmd;
        if (cmd === "bold") wrapText("strong");
        else if (cmd === "italic") wrapText("em");
        else if (cmd === "underline") wrapText("u");
        else if (cmd === "strike") wrapText("s");
        else if (cmd === "h1") wrapBlock("h1");
        else if (cmd === "h2") wrapBlock("h2");
        else if (cmd === "link") createLink();
      });

      function wrapText(tag) {
        const selection = window.getSelection();
        if (!selection.rangeCount) return;
        const range = selection.getRangeAt(0);
        const wrapper = document.createElement(tag);
        range.surroundContents(wrapper);
      }

      function wrapBlock(tag) {
        const selection = window.getSelection();
        if (!selection.rangeCount) return;
        const range = selection.getRangeAt(0);
        const wrapper = document.createElement(tag);
        wrapper.textContent = selection.toString();
        range.deleteContents();
        range.insertNode(wrapper);
      }

      function createLink() {
        const selection = window.getSelection();
        if (!selection.rangeCount) return;
        const url = prompt("Masukkan URL:");
        if (!url) return;
        const a = document.createElement("a");
        a.href = url;
        a.target = "_blank";
        a.textContent = selection.toString();
        const range = selection.getRangeAt(0);
        range.deleteContents();
        range.insertNode(a);
      }
    </script>
  </body>
</html>
